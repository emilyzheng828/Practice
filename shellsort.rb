
def shell_sort(array)
  n = array.size
  (1..(Math.log(n,2).floor)).each do |k| # HACK 
    gap = (n/(2**k)).floor
    puts gap
    forward_steps = n - gap
    forward_steps.times do |i|  
      next unless array[i] > array[gap+i]
        #array[i], array[gap+i] = array[gap+i], array[i]
        swap_num(array,i,gap+i)
        if i > 0
          for j in 1..i do
            if array[i-j] > array[gap+i-j]
              #array[i-j],array[gap+i-j] = array[gap+i-j], array[i-j]
              swap_num(array,i-j,gap+i-j)
            else
              break  
            end
          end
      end
      #puts array.join(",")
    end
  end
  array
  #at_exit { puts "Well done, Emily!"}
end

def swap_num(array,a,b) 
  array[a],array[b] = array[b], array[a]
end
array = [123, -212, -350, 709, 637, -961, -537, -923, 764, 485, -368, -802, -758, 760, 182, 97, 909, -393, 498, -777, 889, 83, -711, 480, 206, -110, 653, 491, 892, -995, 252, 993, 774, 568, 586, -497, 1, 229, -243, 717, 383, -760, -365, 399, -406, 968, -703, 292, -542, -943, -893, -337, 906, 147, -117, 149, -200, 118, -559, -879, -382, 12, -709, 836, 918, 142, 626, 742, 915, -490, -272, 345, 432, 896, -40, 429, 850, -649, -645, -985, 916, 938, -606, -586, 194, 445, 457, -465, 126, 74, -969, -119, 735, 745, -719, 92, 858, 466, -146, 261, -228, 816, 99, 22, 630, 649, 989, -700, 34, -693, -444, -208, 721, -952, -102, -765, -896, -643, 319, -403, 254, 983, 859, 175, -862, -916, 50, 590, 237, -759, 431, 370, 48, 715, -928, 525, -68, 456, -492, 444, 672, -34, -270, 266, -323, 365, -63, 567, 830, 834, 661, 690, -378, -768, -706, -195, 110, -575, -637, 531, -357, -510, -518, -226, -536, 140, -633, 47, 756, -696, -579, -975, 17, -15, 871, 10, -869, 98, 708, -535, 354, 300, 454, -274, 475, -205, -844, 40, 52, 478, 298, 5, -797, -290, 675, -708, 201, -909, 741, 190, -238, 977, -24, 773, -455, -250, -941, -930, -194, -914, -201, 336, -656, 93, 893, -397, 263, -959, 585, -814, -931, 976, 931, -299, -4, 828, 19, 241, -666, 54, 592, -503, -949, 173, 273, -529, 647, 786, -210, 499, -607, 518, -341, 198, 651, 952, 359, -496, 936, -402, 640, -61, 962, 515, 957, 507, 532, 691, -527, 259, 483, -106, -104, -431, 970, 405, -982, -806, 570, 394, 572, 776, -550, 189, 124, 787, -2, -997, -396, 994, -582, -158, -864, -220, -47, -248, 814, 884, 131, -707, -861, 421, -569, -52, 470, 701, 21, -730, -751, 523, 781, 367, 384, 571, 227, 382, -315, 211, -513, -488, 953, 282, 247, 810, -293, 208, 997, -88, -302, -939, -616, 958, -300, 973, -247, -188, 166, -573, -138, -342, 941, 493, -684, -551, -674, 728, 3, 428, 898, -152, -992, 151, -261, 646, 158, -770, 510, 163, 204, -587, 105, 306, 753, -343, -287, -824, 316, -412, 869, 638, -686, -874, -678, -292, 279, -629, -307, 799, -182, -553, 829, 136, -860, -724, -139, 120, -145, 583, -83, -81, -473, 692, -485, 733, -325, 164, -241, 548, -991, -336, -749, 88, 4, 739, 449, -962, 913, -564, -181, 73, 452, -805, -242, 191, 492, -159, -306, -994, 20, 824, -871, 246, 975, 942, 762, 949, -742, -296, -157, 995, 835, -295, -726, -380, -80, 125, 435, -500, -716, -613, 530, 696, -48, -837, -818, -436, 408, 111, -174, -687, 503, 553, 757, 832, 798, 29, 240, 369, -780, 808, -498, 508, -50, 285, 56, 6, 704, -921, 233, -963, -371, 11, -244, 627, 768, -23, -483, 392, -634, -471, -267, -619, 534, -904, -868, -486, -79, -482, -268, 699, -534, -443, 840, 24, 673, 812, -525, 65, 487, -694, -1, -738, 873, -517, 556, 349, -203, 328, 736, 46, -919, 992, -942, 302, -120, 51, -688, -148, 659, 360, 616, -95, 174, 223, 963, -945, 998, -733, 106, 656, -624, 513, -54, 232, -565, -849, 109, 286, -702, -64, -819, 861, 677, 281, -156, 625, -303, -440, 289, 611, -383, -222, 385, 296, -394, -426, -993, -815, -332, -183, 974, -907, 551, 785, 979, -245, 765, -918, 535, -863, 404, -774, -278, 338, -681, -800, -714, 722, 685, -456, -100, -352, -621, -105, 747, 806, 623, -21, 595, -475, 524, -867, -372, 796, 713, 522, 608, 563, -58, -340, 378, -87, 809, -251, -491, -289, 101, -90, -304, 966, -704, -369, -901, -196, -572, -937, -766, -12, -661, 60, -381, -951, -734, 355, -234, 337, 57, 635, 335, -776, 228, 484, 339, 193, 981, -347, 288, -856, -728, 403, -316, 593, -424, 917, -523, 377, -149, -65, 520, -7, -705, -379, -556, -358, -981, 855, 203, -423, 961, 340, -717, 526, -940, 554, 614, -627, -317, 415, 746, -269, 347, 778, -826, 755, -239, 940, 702, -906, -858, 845, -112, 371, 514, 670, 329, -778, -452, -532, 665, -51, -311, -614, 726, 214, 867, -144, 605, 41, 698, -297, -650, -593, 416, -825, -187, 496, 44, 324, 897, 744, 540, 743, -472, -984, 978, -107, 877, 865, 274, 779, 500, 771, -580, 411, 459, 132, -752, -20, -329, -603, -433, -425, 610, 537, -642, -794, 216, 145, 225, 313, -769, -367, -359, -11, 348, -223, -623, -562, -363, 32, -154, -524, -978, -185, 154, -772, -584, -199, -658, 694, -432, 650, -983, 703, 215, 573, 217, 61, -785, 78, 102, -964, -166, 843, -662, -479, 833, -625, 643, 517, 788, -821, -725, 196, 652, 304, 474, -920, -722, -938, 55, 894, -646, 680, -605, -301, 907, 192, 783, 381, 303, -410, -288, -541, 876, -128, 393, 905, 501, -449, -877, 62, 886, -69, -771, 509, 461, 497, 81, -786, 209, -326, 138, 178, -540, -113, 862, -816, 305, -636, -127, 287, 529, -511, 775, -608, 310, -16, -673, -979, -648, 460, 249, -19, 144, -376, -92, -67, -865, -123, -130, -736, 678, 479, -669, -892, -398, 481, 589, 130, 822, 425, -729, -784, 504, -695, -377, 902, -35, 321, 401, -793, 506, -322, 954, -948, 326, 386, 184, 410, 542, 724, 213, -958, 153, -71, -602, -631, 42, 395, 539, -362, 400, -701, 838, -546, -822, -124, -219, -635, -764, 361, -967, -133, 682, -842, 70, -925, -762, -848, 987, -265, -400, 84, 156, -229, -690, 253, 441, -439, 471, 912, 944, -484, 67, -30, 676, 427, 162, 80, 645, 202, -732, -198, -838, 256, -812, 419, -73, -351, -280, 72, 294, 458, -489, -66, -132, 218, 114, -469, 854, -514, -99, 64, 738, -576, -960, -571, 559, 352, -594, 706, 434, -355, 297, 413, 831, 277, -654, 447, 181, -698, -748, 463, -827, 578, -458, -533, -667, 516, 964, 119, 629, -467, -585, 341, 707, -506, -91, -246, -9, -622, -404, -796, -915, 681, 351, 18, 878, 195, -817, -277, 543, 811, -834, 930, 168, 621, 379, -41, -737, -495, 820, -591, -399, 469, 108, -682, 387, 390, 318, 600, 910, 366, -324, 494, -155, -70, -405, 236, -77, -712, -474, -577, -886, -89, -216, -620, -256, 280, -971, 689, -610, 601, 925, 0, 103, 723, 863, 658, 719, 901, 607, 113, -461, -520, -319, 265, 307, -82, 357, -753, 104, 683, -44, 791, -756, 398, 248, -761, -140, -502, -739, -713, 450, -501, 71, -630, 135, 128, 402, -611, -970, 956, 575, 380, -190, -615, 639, 486, 122, -597, 205, 169, 924, 767, -167, 185, 437, -745, -39, -481, 671, -754, -505, 448, 584, -727, -209, 839, 283, -987, -626, -773, 875, -26, -599, -38, -859, -305, -763, 813, 950, -972, 467, -29, 686, -211, -808, -897, -543, -409, -944, 597, -168, 9, 613, -5, 222, 25, -435, -258, -670, 988, 446, -391, 267, -72, 662, -675, 372, 230, -464, -494, 900, 982, -271, -755, -374, -22, 219, -13, 275, 574, -885, -723, -515, -137, -956, 815, -857, -668, -647, -447, 272, -260, -560, -976, 827, -830, 617, 655, 943, -526, -294, -882, 782, 866, 947, -545, 660, 308, -468, -448, -757, 519, 582, -854, 552, 904, 350, 376, 730, -672, 710, 476, 754, -49, 712, 632, 576, 389, 939, 801, 157, -912, 560, -335, -59, -42, 426, 343, 45, -902, -530, 991, 780, -872, -480, -55, -136, -224, -889, -746, -743, -339, -583, 309, 868, 301, -679, 177, 588, -831, -375, 409, -233, 107, -320, -78, 187, -789, 967, 75, 971, 462, 39, -321, 127, -331, -595, 628, -699, -609, 687, 27, -116, -841, -781, 908, -276, 37, -779, -720, -25, -653, 258, 311, -361, -973, 934, -115, 464, -170, -252, -217, 929, 648, -28, 290, -454, 695, 980, 663, 63, -908, -143, 731, 527, 609, -566, 137, 679, -554, -121, -638, 243, -651, -165, -990, -557, -811, 468, -417, -601, -873, 772, 549, 622, -141, 320, -310, -617, -731, -416, -932, -632, -850, 375, 749, -683, 15, -947, -460, 100, 550, 693, 502, -881, 684, 727, 751, -175, -544, 880, 634, 38, -227, -476, 58, -652, 555, 700, -459, 674, 14, -775, 667, -438, 602, -327, -697, -333, 823, -922, -344, -563, 242, 740, 849, 317, -160, -283, -153, -744, 777, 473, -353, 624, -895, -840, -285, -924, -411, -184, -950, 789, -721, -851, 725, -561, 990, 826, -659, 295, -988, -692, 7, 633, 455, -954, -829, 231, 546, 521, -588, 604, 758, -31, 271, -547, -792, -14, 581, 430, -366, -442, 538, 821, -790, -135, 2, 356, 490, -430, 846, -782, 334, -56, -798, -451, -262, 239, -750, -255, -169, 141, -478, 397, 133, 705, 161, 536, -578, -414, -163, 85, -286, 759, 946, 797, 935, -894, 362, 414, 951, 422, -218, -903, 769, 577, 69, -791, 547, -408, -207, 268, -567, -462, -548, -76, 68, 95, -214, 396, 856, 323, -309, -685, 587, 407, 842, -934, -509, 160, -395, -249, 795, 960, -809, 171, 353, -17, 533, 770, -161, 333, 183, 420, 330, 200, -574, 528, -235, -349, -236, -953, -348, 453, 882, -86, 36, 115, 927, 837, -986, -308, -134, -240, -390, 557, -555, 544, -46, 87, 732, -600, -193, -926, 599, 885, 13, 8, -528, 442, -37, -202, 374, -835, -230, 207, -803, 860, -888, 424, -663, -989, -43, 996, 874, -878, -421, -162, -1000, -832, -664, 879, 262, 697, 212, -84, -741, -644, -466, 986, 558, 16, 170, -318, 332, 186, -477, 488, 363, 86, 841, -538, 984, 711, -225, -418, 210, -747, -415, 331, -568, -589, 30, -98, -783, 919, -420, 327, 612, -847, 43, 439, 920, -493, -689, 851, -429, -671, -387, 921, 580, 852, -254, -93, -422, -178, 561, -828, 417, 734, 199, 750, -176, -933, -291, 899, -18, -122, 664, 293, -820, 146, 344, 26, 562, -298, 579, 49, 641, -125, 489, 244, -845, -386, 472, -570, -657, -334, -434, 235, 618, 406, 636, -767, -839, -62, 591, -180, -641, 928, -109, -898, -880, 790, -522, 818, 117, 620, -96, -457, -836, 299, 714, -60, -905, 903, 761, 221, -74, -370, -373, 794, 440, 176, -314, 260, -384, -94, 803, -6, 932, 79, 312, -103, -142, -126, 594, 615, -204, 933, 792, 644, -499, 96, 922, 631, 959, -463, -389, -27, -253, -259, 596, 870, -935, -618, 642, -680, -999, 238, -281, 188, -266, 90, 545, -3, 793, -552, -913, -740, 250, 688, 423, 598, 150, -346, -660, -823, 890, 179, 847, 418, -446, -33, 342, -186, -955, -787, 278, -853, -413, 895, 33, -875, -437, -676, -172, 565, -612, 251, 358, -427, -45, -917, -911, 322, 752, -108, 883, -470, -936, -804, 606, -75, -715, -392, -189, -957, 257, -213, -549, -558, 748, -504, 668, -628, 657, -810, 819, 511, 148, -946, 864, 276, 77, 346, -487, -53, 234, 603, -899, -221, 495, 965, 887, -665, -710, 937, -927, -171, 165, 451, -131, 94, -263, 888, -32, -852, -231, 82, -890, -884, 804, -521, -36, -428, 669, -264, 59, 364, -338, -330, -129, -97, 805, 718, -179, 766, -192, -795, -10, 28, -114, -354, 89, 848, 373, -891, 224, -870, -846, 269, 143, -598, 569, 438, -101, -531, -788, 737, 1000, -833, 926, -279, 155, -450, -677, -807, 825, 666, 465, -197, 226, -388, -718, 180, -237, 412, -441, -206, -966, -910, -883, -215, -539, -385, -968, -590, -519, 134, 245, -735, 129, 857, -57, -419, -312, -876, -118, -801, -445, 955, -151, 112, 512, -508, -596, 541, 807, 152, -855, -177, 911, 436, 800, 802, 566, -900, 139, -998, 284, -275, 53, 923, 720, -8, 763, -453, -150, -887, 121, -284, 264, -282, 881, -799, 482, 654, 872, -85, 891, 172, -516, -360, 945, 817, 619, -965, -639, 220, 391, -843, -364, 505, -147, -345, -977, 948, 31, -356, 477, -592, -313, -164, -401, -328, 116, -929, 914, -604, 969, 784, -273, 314, -191, 76, 564, 315, 729, -257, -581, -980, 844, 368, 255, 35, -813, -640, 91, 433, -655, 23, -407, 972, 325, -111, 999, -232, 853, 197, 167, 443, -996, -866, 66, -507, 388, -974, 291, 716, 159, -691, 270, 985, -512, -17333,111,0,10, 24,334,2999,-11000,293,2220,11,-333333,0,19,20,30]
array2 = array.dup
puts shell_sort(array) == array2.sort
          
